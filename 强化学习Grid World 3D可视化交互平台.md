 

 

# ***\*强化学习Grid World 3D可视化交互平台\****

 

 

 

 

 

 

 

 

 

| ***\*项目名称\**** | ***\*强化学习Grid World 3D可视化交互平台\**** |
| ------------------ | --------------------------------------------- |
| 项目代号           | RL-GridWorld-3D                               |
| 文档版本           | v1.0                                          |
| 创建日期           | 2024-12-04                                    |
| 项目类型           | 教育科研软件                                  |
| 开发模式           | 敏捷开发（Scrum）                             |
| 计划周期           | 12周（3个月）                                 |

 



目录

[强化学习Grid World 3D可视化交互平台 ](#_Toc169168370 )

[1. 项目概述 ](#_Toc2091929609 )

[1.1 项目背景 ](#_Toc458669779 )

[1.2 项目愿景 ](#_Toc1544166570 )

[1.3 核心价值 ](#_Toc467667995 )

[2. 项目目标与范围 ](#_Toc305843945 )

[2.1 SMART目标 ](#_Toc1390816344 )

[2.2 功能范围 ](#_Toc90796013 )

[2.3 非功能性需求 ](#_Toc1295201121 )

[3. 技术架构 ](#_Toc1550994655 )

[3.1 整体架构图 ](#_Toc1410659299 )

[3.2 前端技术栈 ](#_Toc731375413 )

[3.3 后端技术栈 ](#_Toc30170863 )

[3.4 开发工具链 ](#_Toc275553749 )

[3.5 部署方案 ](#_Toc1257116511 )

[4. 功能模块设计 ](#_Toc1413081191 )

[4.1 前端模块划分 ](#_Toc633924964 )

[4.2 后端模块划分 ](#_Toc710497181 )

[4.3 数据库设计 ](#_Toc1317043747 )

[4.4 API接口设计 ](#_Toc1440306200 )

[5. 开发阶段规划 ](#_Toc790634416 )

[5.1 总体时间规划（12周） ](#_Toc1711305723 )

[5.2 阶段一：项目初始化 & 基础架构（Week 1-2） ](#_Toc666802190 )

[5.3 阶段二：核心功能开发 - Basic Gridworld（Week 3-5） ](#_Toc1374737284 )

[5.4 阶段三：扩展功能开发（Week 6-8） ](#_Toc432974115 )

[5.5 阶段四：3D可视化增强（Week 9-10） ](#_Toc1321354769 )

[5.6 阶段五：测试与优化（Week 11） ](#_Toc881208956 )

[5.7 阶段六：部署与交付（Week 12） ](#_Toc1431693780 )

[6. 团队组织与分工 ](#_Toc2070579472 )

[6.1 团队结构 ](#_Toc256686269 )

[6.2 角色职责 ](#_Toc1978959907 )

[6.3 协作机制 ](#_Toc152432213 )

[7. 技术标准与规范 ](#_Toc2127696667 )

[7.1 编码规范 ](#_Toc300192425 )

[7.2 Git工作流 ](#_Toc895000172 )

[7.3 API设计规范 ](#_Toc1292427216 )

[7.4 数据库规范 ](#_Toc27129907 )

[7.5 测试规范 ](#_Toc705813785 )

[8. 质量保证计划 ](#_Toc2060102114 )

[8.1 代码质量 ](#_Toc257389417 )

[8.2 性能指标 ](#_Toc911866461 )

[8.3 测试策略 ](#_Toc1296305035 )

[8.4 缺陷管理 ](#_Toc777124430 )

[9. 风险管理 ](#_Toc134753956 )

[9.1 技术风险 ](#_Toc1361974554 )

[9.2 项目风险 ](#_Toc678135705 )

[9.3 应急预案 ](#_Toc731079306 )

[10. 交付物清单 ](#_Toc1495951455 )

[10.1 源代码 ](#_Toc1865048756 )

[10.2 文档 ](#_Toc1203130480 )

[10.3 演示材料 ](#_Toc307957208 )

[10.4 实验相关 ](#_Toc401205586 )

[附录 ](#_Toc2111115969 )

[A. 术语表 ](#_Toc801275249 )

[B. 参考资料 ](#_Toc163159606 )

[C. 联系方式 ](#_Toc2034364470 )

[版本历史 ](#_Toc1476503403 )

 

 



## 1. 项目概述

### ***\*1.1 项目背景\****

本项目旨在开发一个交互式3D可视化平台，用于强化学习经典Grid World问题的教学与实验。项目基于以下实验需求：

实验一：基本4×4 Gridworld（动态规划算法）

实验二：Windy Gridworld（Sarsa算法）

实验三：Cliff Walking（Sarsa vs Q-Learning对比）

传统2D图形界面难以直观展示状态值函数、策略演化等多维信息，本项目通过3D立体可视化、实时交互控制、算法对比分析等创新手段，提升强化学习的教学效果和研究效率。

### ***\*1.2 项目愿景\****

打造一个国际领先的强化学习可视化教学平台，成为高校AI课程、在线学习平台、科研实验的标准工具。

### ***\*1.3 核心价值\****

· **教学价值**：降低强化学习理解门槛，提升学习兴趣

· **科研价值**：快速验证算法思想，加速研究迭代

· **工程价值**：前后端分离架构，可扩展至其他RL问题

· **商业价值**：可作为教育产品或SaaS服务

## 2. 项目目标与范围

### ***\*2.1 SMART目标\****

| ***\*维度\****           | ***\*目标描述\****                                           |
| ------------------------ | ------------------------------------------------------------ |
| **Specific**（具体）     | 开发支持3种Grid World场景的3D可视化平台，包含动态规划、Sarsa、Q-Learning三种算法 |
| **Measurable**（可衡量） | 支持最大20×20网格，算法迭代帧率≥30fps，用户操作响应时间<100ms |
| **Achievable**（可实现） | 团队具备前端、后端、算法开发能力，技术栈成熟稳定             |
| **Relevant**（相关）     | 满足实验课程需求，可应用于教学科研场景                       |
| **Time-bound**（时限）   | 12周内完成MVP版本，16周内完成完整版                          |

### ***\*2.2 功能范围\****

#### ***\*核心功能（Must Have）\****

· ✅ 3D网格世界渲染与交互编辑

· ✅ 三种算法实现（DP、Sarsa、Q-Learning）

· ✅ 实时算法迭代可视化

· ✅ 状态值/Q值热力图显示

· ✅ 策略箭头可视化

· ✅ 参数调节控制面板

· ✅ 实验数据记录（XML格式）

· ✅ 收敛曲线图表分析

#### ***\*重要功能（Should Have）\****

· ⭐ Agent动画移动与轨迹回放

· ⭐ 算法对比模式（分屏显示）

· ⭐ 风力粒子效果（Windy场景）

· ⭐ 实验历史保存与加载

· ⭐ 多视角摄像机控制

#### ***\*期望功能（Could Have）\****

· �� 第一人称跟随视角

· �� 爆炸/粒子特效

· �� 音效配合

· �� 导出视频/GIF

· �� 社区分享功能

#### ***\*暂不实现（Won't Have）\****

· ❌ 多智能体协同

· ❌ 连续动作空间

· ❌ 深度强化学习算法

### ***\*2.3 非功能性需求\****

| ***\*类别\**** | ***\*指标\****                                        |
| -------------- | ----------------------------------------------------- |
| **性能**       | 20×20网格渲染帧率≥30fps，算法计算延迟<50ms            |
| **可用性**     | 新用户5分钟内完成首次实验，操作学习成本低             |
| **兼容性**     | 支持Chrome/Firefox/Safari最新版，屏幕分辨率≥1920×1080 |
| **可扩展性**   | 架构支持新增算法、新场景，代码耦合度低                |
| **可维护性**   | 代码覆盖率≥80%，文档完整，遵循编码规范                |
| **安全性**     | 输入验证、API鉴权、数据加密传输                       |

## 3. 技术架构

### ***\*3.1 整体架构图\****

┌─────────────────────────────────────────────────────────┐

│           客户端层（Browser）           │

├─────────────────────────────────────────────────────────┤

│  React + TypeScript + Three.js（3D渲染）         │

│  ├─ UI组件层（Ant Design）                │

│  ├─ 3D场景层（React Three Fiber）             │

│  ├─ 状态管理层（Zustand）                 │

│  └─ 通信层（Axios + WebSocket）              │

└─────────────────────────────────────────────────────────┘

​             ↕ HTTP/WebSocket

┌─────────────────────────────────────────────────────────┐

│           服务端层（Server）           │

├─────────────────────────────────────────────────────────┤

│  FastAPI + Python 3.10+                 │

│  ├─ API路由层（RESTful）                 │

│  ├─ WebSocket服务层（实时推送）              │

│  ├─ 算法引擎层（DP/Sarsa/Q-Learning）           │

│  ├─ 环境模拟层（Gymnasium）                │

│  └─ 数据持久层（SQLite + XML）              │

└─────────────────────────────────────────────────────────┘

​             ↕ ORM

┌─────────────────────────────────────────────────────────┐

│           数据层（Database）           │

├─────────────────────────────────────────────────────────┤

│  ├─ SQLite（实验配置、历史记录）              │

│  ├─ XML文件（迭代日志、符合实验要求）           │

│  └─ Redis（可选，缓存计算结果）              │

└─────────────────────────────────────────────────────────┘

### ***\*3.2 前端技术栈\****

| ***\*技术类别\**** | ***\*技术选型\****          | ***\*版本\**** | ***\*用途\****       |
| ------------------ | --------------------------- | -------------- | -------------------- |
| **基础框架**       | React                       | 18.x           | UI组件化开发         |
| **语言**           | TypeScript                  | 5.x            | 类型安全             |
| **构建工具**       | Vite                        | 5.x            | 快速开发构建         |
| **3D渲染**         | Three.js                    | r160+          | WebGL图形引擎        |
| **3D React封装**   | React Three Fiber           | 8.x            | 声明式3D开发         |
| **3D工具库**       | @react-three/drei           | 9.x            | 相机、光照、加载器   |
| **后期处理**       | @react-three/postprocessing | 2.x            | Bloom、SSAO特效      |
| **UI组件**         | Ant Design                  | 5.x            | 控制面板、表单       |
| **样式方案**       | Tailwind CSS                | 3.x            | 原子化CSS            |
| **图表库**         | Recharts                    | 2.x            | 收敛曲线、数据可视化 |
| **状态管理**       | Zustand                     | 4.x            | 轻量级状态管理       |
| **HTTP客户端**     | Axios                       | 1.x            | API请求              |
| **WebSocket**      | Socket.IO Client            | 4.x            | 实时通信             |
| **动画库**         | Framer Motion               | 10.x           | UI动画               |
| **数学库**         | GLMatrix                    | 3.x            | 向量/矩阵计算        |

### ***\*3.3 后端技术栈\****

| ***\*技术类别\**** | ***\*技术选型\**** | ***\*版本\**** | ***\*用途\**** |
| ------------------ | ------------------ | -------------- | -------------- |
| **Web框架**        | FastAPI            | 0.104+         | 异步API服务    |
| **语言**           | Python             | 3.10+          | 后端开发       |
| **ASGI服务器**     | Uvicorn            | 0.24+          | 高性能服务器   |
| **WebSocket**      | Socket.IO (Python) | 5.x            | 实时推送       |
| **数值计算**       | NumPy              | 1.26+          | 矩阵运算       |
| **RL环境**         | Gymnasium          | 0.29+          | 标准环境接口   |
| **数据处理**       | Pandas             | 2.1+           | 数据分析       |
| **数据验证**       | Pydantic           | 2.5+           | 请求/响应验证  |
| **ORM**            | SQLAlchemy         | 2.0+           | 数据库操作     |
| **数据库**         | SQLite             | 3.x            | 轻量级存储     |
| **XML处理**        | lxml               | 4.9+           | XML日志生成    |
| **测试框架**       | Pytest             | 7.4+           | 单元测试       |
| **代码规范**       | Black + Flake8     | -              | 代码格式化     |

### ***\*3.4 开发工具链\****

| ***\*工具类型\**** | ***\*工具名称\****              | ***\*用途\****       |
| ------------------ | ------------------------------- | -------------------- |
| **版本控制**       | Git + GitHub                    | 代码托管、协作开发   |
| **项目管理**       | Jira / GitHub Projects          | 任务跟踪、Sprint管理 |
| **API文档**        | FastAPI自动文档 + Swagger       | API接口文档          |
| **API测试**        | Postman / Insomnia              | 接口调试             |
| **代码编辑器**     | VS Code                         | 统一开发环境         |
| **包管理**         | npm（前端）+ Poetry（后端）     | 依赖管理             |
| **CI/CD**          | GitHub Actions                  | 自动化测试、部署     |
| **容器化**         | Docker + Docker Compose         | 环境一致性           |
| **监控日志**       | Winston（前端）+ Loguru（后端） | 日志记录             |

### ***\*3.5 部署方案\****

#### ***\*开发环境\****

· 前端：npm run dev (localhost:16000)

· 后端：uvicorn main:app --reload (localhost:16210)

#### ***\*生产环境\****

· **前端部署**：Vercel / Netlify（自动化部署）

· **后端部署**：Railway / Render / AWS EC2

· **数据库**： PostgreSQL

## 4. 功能模块设计

### ***\*4.1 前端模块划分\****

src/

├── components/      # 可复用组件

│  ├── UI/       # 通用UI组件

│  │  ├── Button/

│  │  ├── Panel/

│  │  ├── Slider/

│  │  └── Modal/

│  ├── Scene3D/     # 3D场景组件

│  │  ├── GridWorld/  # 网格世界

│  │  ├── Agent/    # Agent角色

│  │  ├── Arrow/    # 策略箭头

│  │  ├── Particle/  # 粒子系统

│  │  └── Camera/   # 相机控制

│  ├── Charts/     # 图表组件

│  │  ├── LineChart/  # 收敛曲线

│  │  ├── Heatmap/   # 热力图

│  │  └── BarChart/  # 柱状图

│  └── Controls/    # 控制面板

│    ├── ParameterPanel/  # 参数调节

│    ├── AlgorithmSelector/ # 算法选择

│    └── TimelineControl/  # 时间轴

├── pages/        # 页面组件

│  ├── Home/      # 主页

│  ├── Experiment/   # 实验页面

│  │  ├── BasicGrid/  # 基本Gridworld

│  │  ├── WindyGrid/  # Windy Gridworld

│  │  └── CliffWalk/  # Cliff Walking

│  └── History/     # 历史记录

├── hooks/        # 自定义Hooks

│  ├── useWebSocket.ts

│  ├── useAlgorithm.ts

│  └── use3DScene.ts

├── store/        # 状态管理

│  ├── experimentStore.ts

│  ├── sceneStore.ts

│  └── uiStore.ts

├── services/      # API服务

│  ├── api.ts      # HTTP请求

│  └── websocket.ts   # WebSocket

├── utils/        # 工具函数

│  ├── math.ts     # 数学计算

│  ├── transform.ts   # 数据转换

│  └── logger.ts    # 日志工具

└── types/        # TypeScript类型定义

  ├── algorithm.ts

  ├── environment.ts

  └── visualization.ts

#### ***\*4.1\*******\*.1\*******\*实验场景子系统\****

实验场景子系统是本平台的核心可视化模块，负责呈现三类教学实验（基础 Gridworld、Windy Gridworld、Cliff Walking）的 3D 实验环境、智能体行为反馈以及算法训练过程的可视化展示。该子系统与控制面板、数据面板共同构成实验交互界面，通过统一的交互流程实现实验配置、运行、观察与结果导出。

本节从整体布局、界面结构、三类实验的可视化适配设计以及跨实验通用功能等方面，对前端模块进行系统性说明。

4.1.1 整体界面布局设计

实验场景界面采用“三栏式”固定布局，以提升不同实验间操作的一致性，并确保实验操作、3D 可视化与数据分析能够同步呈现。

（1）布局结构

| 区域                      | 功能定位                       | 占屏比例 | 主要内容                                                    |
| ------------------------- | ------------------------------ | -------- | ----------------------------------------------------------- |
| 中间：3D 主视窗（核心区） | 实验环境可视化、智能体运动展示 | 60%–70%  | 网格渲染、风力/悬崖等环境特效、飞船动画、值函数与策略可视化 |
| 左侧：实验控制面板        | 实验配置与算法控制             | 20%–25%  | 实验选择、参数输入、算法设置、训练控制、场景编辑            |
| 右侧：数据与日志面板      | 数据反馈与分析图表             | 10%–15%  | 实时数据、回合统计、策略对比、日志导出                      |

（2）视觉风格

整体采用宇宙主题（深空黑 + 星云蓝）。

不同实验模块配置专属辅助色：

基础 Gridworld：科技绿

Windy Gridworld：极光紫

Cliff Walking：警示橙

顶部状态条统一展示：当前实验类型、算法名称、迭代进度。

（3）统一操作流程

所有实验遵循相同交互步骤：

选择实验类型

配置场景与参数

启动训练（或手动控制）

观察 3D 场景反馈与数据变化

分析图表与结果

导出日志与实验报告

该流程贯穿平台所有实验，降低学生上手成本。

4.1.2 3D 主视窗设计（核心渲染模块）

3D 主视窗负责对实验环境与智能体行为进行可视化渲染，具有以下通用特性：

（1）网格渲染与结构映射

所有实验均以 N×N 网格为基础结构。

网格节点被设计为“宇宙空间站舱室”：

普通节点：灰色舱室

终止状态：金色发光“核心控制舱”

起点：蓝色“发射台”图标

悬崖区域（实验三）：红色半透明覆盖并附加碎石粒子特效

风力区域（实验二）：特定列叠加向上粒子流

（2）智能体渲染与动画反馈

智能体以“宇宙飞船”模型呈现。

每一步动作具备平滑运动动画与推进器尾焰反馈。

奖励提示以悬浮标签形式出现在飞船旁（如“奖励：-1”）。

（3）策略与值函数可视化

策略可视化：在每格显示箭头，表示最优策略或动作概率分布。

状态值可视化：通过高度图或颜色渐变（蓝→红）表示 $V(s)$ 或 $Q(s,a)$ 的大小。

(4）多视角交互控制

提供三类标准视角：

俯视视角：用于查看全局策略分布

跟随视角：相机跟随飞船，可观察训练时的决策过程

目标视角：聚焦终点区域，便于分析算法对目标的趋近性

支持鼠标旋转、缩放、平移及平滑视角切换过渡。

4.1.3 实验控制面板设计（左侧子系统）

控制面板用于实验初始化、参数调节与算法训练管理。其结构随实验类型动态调整，始终保持操作区域与功能区域一致。

（1）实验选择模块

下拉菜单选择实验类型：

基础 Gridworld

Windy Gridworld

Cliff Walking

选择后其他模块自动切换为对应实验的配置结构。

（2）通用场景配置模块

所有实验共享以下配置项：

网格尺寸（默认 4×4，可扩展至 20×20）

基础奖励设置（步长奖励、终止奖励等）

（3）算法与训练控制模块

包括：

算法选择（DP/Sarsa/Q-Learning）

学习率 α、折扣因子 γ、探索率 ε 等参数

训练控制按钮：

初始化

开始训练

暂停

单步执行

重置实验

（4）实验专属配置模块

各实验的特定环境参数通过附加面板呈现：

| 实验类型        | 专属配置项                                     |
| --------------- | ---------------------------------------------- |
| 基础 Gridworld  | 奖励设定、策略初始化模式                       |
| Windy Gridworld | 每列风力强度、风力特效开关                     |
| Cliff Walking   | 悬崖惩罚值、悬崖区域编辑（拖拽选区或输入区间） |

 

4.1.4 数据与日志面板设计（右侧子系统）

右侧数据面板用于呈现实验过程中产生的数值、曲线、统计信息与日志。

（1）实时数据表

内容包括：

状态编号

动作

即时奖励

值函数（$V(s)$）或动作值（$Q(s,a)$）

Windy 实验中增加“风力影响”字段

Cliff 实验中增加“是否触发悬崖”字段

（2）图表分析模块

根据实验需求自动生成以下图表：

收敛曲线：回归随回合变化趋势

单状态值变化曲线（基础实验）

动作频率饼图（Windy 实验）

双算法收敛对比曲线（Cliff 实验）

（3）实验日志管理模块

记录训练过程中所有迭代数据（按回合/步数）

支持 XML 导出，文件名以实验类型与时间自动生成

Cliff 实验支持“合并导出”Sarsa/Q-Learning 日志，便于对比分析

4.1.5 三类实验的前端适配与功能落地

以下分别说明三类实验在 3D 场景与 UI 层的具体适配。

（一）基础 Gridworld 实验的前端适配

1. 场景可视化

4×4 基础网格映射为空间站舱室

终止状态以金色核心舱渲染

支持热力图显示 $V(s)$ 的变化趋势

箭头图层用于策略展示

2. 操作交互

支持 DP 策略评估与策略迭代流程

可手动控制飞船移动（暂停状态下）

3. 数据呈现

状态值收敛曲线

初始策略 vs 最优策略的图像对比

（二）Windy Gridworld 实验的前端适配

1. 场景可视化

网格列展示风力强度

叠加向上粒子流作为风力视觉化

飞船受风时触发“漂移提示”与动态位移

2. 操作交互

配置多列不同风力强度

Sarsa 算法参数可动态调整

特效开关控制风力粒子渲染

3. 数据呈现

风力影响记录

动作选择频率统计图

回合回报收敛曲线

（三）Cliff Walking 实验的前端适配

1. 场景可视化

悬崖区域覆盖陨石带特效（红色半透明）

飞船落入悬崖触发爆炸动画与奖励提示

双算法分屏展示策略差异（Sarsa / Q-Learning）

2. 操作交互

支持悬崖区域的拖拽绘制或指令式输入

支持算法选择与双算法对比模式

对比模式可选择“同步训练”或“独立控制”

3. 数据呈现

悬崖触发次数

Q-Learning 与 Sarsa 的策略与收敛对比

4.1.6 跨实验通用功能设计

（1）实验切换与状态保持

切换实验时自动保存参数配置

提供最近实验记录（最多三条），支持快速恢复

（2）实验分析辅助工具

在数据面板提供“实验结论模板”

支持自动整理实验关键指标并导出文本文件

4.1.7 小结

实验场景子系统通过统一的三栏结构、宇宙主题视觉风格以及模块化的控制与数据面板，实现了对三类强化学习实验的完整可视化支持。该设计满足教学实验的操作需求、交互体验要求，并与系统整体架构保持一致，可作为平台前端的核心模块进行开发与扩展。

### ***\*4.2 后端模块划分\****

backend/

├── app/

│  ├── api/       # API路由

│  │  ├── v1/

│  │  │  ├── environment.py  # 环境管理API

│  │  │  ├── algorithm.py   # 算法控制API

│  │  │  ├── experiment.py  # 实验管理API

│  │  │  └── export.py    # 数据导出API

│  │  └── websocket.py     # WebSocket处理

│  ├── core/      # 核心模块

│  │  ├── config.py  # 配置管理

│  │  ├── security.py # 安全认证

│  │  └── logger.py  # 日志配置

│  ├── models/     # 数据模型

│  │  ├── environment.py

│  │  ├── agent.py

│  │  └── experiment.py

│  ├── schemas/     # Pydantic模式

│  │  ├── requests.py

│  │  └── responses.py

│  ├── services/    # 业务逻辑

│  │  ├── algorithm_service.py

│  │  │  ├── dp_solver.py     # 动态规划

│  │  │  ├── sarsa_agent.py    # Sarsa算法

│  │  │  └── qlearning_agent.py  # Q-Learning

│  │  ├── environment_service.py

│  │  │  ├── basic_grid.py

│  │  │  ├── windy_grid.py

│  │  │  └── cliff_grid.py

│  │  └── export_service.py

│  │    ├── xml_exporter.py

│  │    └── report_generator.py

│  ├── db/       # 数据库

│  │  ├── session.py

│  │  └── migrations/

│  └── utils/      # 工具函数

│    ├── math_utils.py

│    └── visualization_utils.py

├── tests/        # 测试

│  ├── unit/

│  ├── integration/

│  └── e2e/

├── data/        # 数据存储

│  ├── experiments/   # 实验数据

│  └── logs/      # 日志文件

├── main.py       # 应用入口

└── requirements.txt   # 依赖列表

### ***\*4.3 数据库设计\****

#### ***\*实验表（experiments）\****

CREATE TABLE experiments (

  id INTEGER PRIMARY KEY AUTOINCREMENT,

  name VARCHAR(100) NOT NULL,

  type VARCHAR(20) NOT NULL,  -- 'basic', 'windy', 'cliff'

  algorithm VARCHAR(20) NOT NULL,  -- 'dp', 'sarsa', 'qlearning'

  config JSON NOT NULL,  -- 环境配置

  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

  status VARCHAR(20) DEFAULT 'created'  -- 'created', 'running', 'completed', 'failed'

);

#### ***\*迭代记录表（iterations）\****

CREATE TABLE iterations (

  id INTEGER PRIMARY KEY AUTOINCREMENT,

  experiment_id INTEGER NOT NULL,

  episode INTEGER NOT NULL,

  step INTEGER NOT NULL,

  state VARCHAR(20) NOT NULL,

  action VARCHAR(10) NOT NULL,

  reward REAL NOT NULL,

  q_value REAL,

  v_value REAL,

  timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

  FOREIGN KEY (experiment_id) REFERENCES experiments(id)

);

### ***\*4.4 API接口设计\****

#### ***\*RESTful API\****

| ***\*方法\**** | ***\*端点\****                | ***\*功能\**** | ***\*请求体\****            | ***\*响应\****             |
| -------------- | ----------------------------- | -------------- | --------------------------- | -------------------------- |
| POST           | /api/v1/environment           | 创建环境       | {type, grid_size, config}   | {env_id, status}           |
| GET            | /api/v1/environment/{id}      | 获取环境信息   | -                           | {env_id, config, state}    |
| PUT            | /api/v1/environment/{id}      | 更新环境       | {config}                    | {status}                   |
| DELETE         | /api/v1/environment/{id}      | 删除环境       | -                           | {status}                   |
| POST           | /api/v1/algorithm/start       | 启动算法       | {env_id, algorithm, params} | {exp_id, status}           |
| POST           | /api/v1/algorithm/stop        | 停止算法       | {exp_id}                    | {status}                   |
| GET            | /api/v1/algorithm/status/{id} | 查询状态       | -                           | {status, progress}         |
| GET            | /api/v1/experiment            | 实验列表       | ?page=1&size=10             | {experiments[], total}     |
| GET            | /api/v1/experiment/{id}       | 实验详情       | -                           | {experiment, iterations[]} |
| DELETE         | /api/v1/experiment/{id}       | 删除实验       | -                           | {status}                   |
| GET            | /api/v1/export/xml/{id}       | 导出XML        | -                           | XML文件                    |
| GET            | /api/v1/export/report/{id}    | 导出报告       | -                           | PDF文件                    |

#### ***\*WebSocket事件\****

| ***\*事件名\****    | ***\*方向\**** | ***\*数据格式\****                                         | ***\*说明\**** |
| ------------------- | -------------- | ---------------------------------------------------------- | -------------- |
| connect             | Client→Server  | -                                                          | 建立连接       |
| subscribe           | Client→Server  | {exp_id}                                                   | 订阅实验       |
| iteration_update    | Server→Client  | {episode, step, state, action, reward, q_values, v_values} | 迭代更新       |
| episode_complete    | Server→Client  | {episode, total_reward, steps}                             | 回合完成       |
| experiment_complete | Server→Client  | {exp_id, final_policy, final_values}                       | 实验完成       |
| error               | Server→Client  | {code, message}                                            | 错误通知       |

## 5. 开发阶段规划

### ***\*5.1 总体时间规划（12周）\****

• Week 1–2：阶段一 – 项目初始化与前后端基础架构落地

• Week 3–5：阶段二 – 核心功能开发（Basic Gridworld 全栈实现）

• Week 6–8：阶段三 – 扩展功能开发（Windy Gridworld + Cliff Walking 全栈实现）

• Week 9–10：阶段四 – 3D 可视化与教学辅助增强

• Week 11：阶段五 – 测试与教学场景验证

• Week 12：阶段六 – 部署与文档交付

 

### ***\*5.2 阶段一：项目初始化 & 基础架构（Week 1-2）\****

#### ***\*�� 阶段目标\****

建立完整的开发环境和基础架构，完成技术预研和原型验证。

#### ***\*�� 详细任务\****

**Week 1: 环境搭建与架构设计**

| ***\*任务编号\**** | ***\*任务名称\****     | ***\*主要内容\****                                           | ***\*产出物\**** |
| ------------------ | ---------------------- | ------------------------------------------------------------ | ---------------- |
| T1.1               | 项目仓库与分支策略     | 初始化 Git 仓库，约定 main/dev/feature-* 分支使用规则        | 仓库与分支规范   |
| T1.2               | 前端脚手架搭建         | 创建 React + Three.js + 状态管理（如 Zustand）项目；配置基础路由 | 前端工程骨架     |
| T1.3               | 后端工程初始化         | 按已设计架构创建 Python 后端（如 FastAPI/Flask），划分 modules：env、algo、log、api | 后端工程骨架     |
| T1.4               | 数据结构与接口协议固化 | 根据实验四需求，确定环境初始化参数、迭代数据结构（state, action, reward, value）、XML 字段统一规范 | 接口协议说明文档 |
| T1.5               | 数据库/文件存储规划    | 确定日志（XML）与实验配置的存储方式（文件系统/简单 DB）      | 存储设计草案     |

**Week 2:** **三栏布局骨架与通信原型**

| ***\*任务编号\**** | ***\*任务名称\****         | ***\*主要内容\****                                           | ***\*产出物\****     |
| ------------------ | -------------------------- | ------------------------------------------------------------ | -------------------- |
| T2.1               | /grid-world 实验主页面创建 | 建立统一的实验入口页面，采用中间 3D 主视窗 + 左控制面板 + 右数据面板的三栏布局 | 实验主页面骨架       |
| T2.2               | 3D 网格与 Agent 原型       | 使用 Three.js 渲染 N×N 网格与一个简单 Agent 模型，支持基础移动动画 | GridWorld3D 原型组件 |
| T2.3               | 顶部状态条与主题           | 实现宇宙主题配色（深空黑/星云蓝）及实验名称、算法名称、迭代进度显示的状态条 | 状态条组件           |
| T2.4               | REST + WebSocket 通信原型  | 实现简化版接口（如模拟迭代数据流），前端可订阅并驱动 Agent 在网格中移动 | 通信 Demo            |
| T2.5               | XML 导出调用流程打通       | 约定日志导出接口 URL、参数与返回格式，在前端提供“导出 XML”按钮实现文件下载 | 最小导出闭环         |

✅ 阶段验收标准

 • 前后端项目均可运行，基础路由与模块结构明确

 • /grid-world 页面三栏布局成型，3D 网格与 Agent 可正确显示

 • 前端可通过固定格式的迭代数据驱动 Agent 移动

 • 前端已能调用后端的占位导出接口完成一次文件下载（即便内容为模拟数据）

### ***\*5.3 阶段二：\*******\*核心功能开发 – Basic Gridworld 全栈实现（Week 3–5）\****

#### ***\*�� 阶段目标\****

实现基本 4×4 Gridworld 实验的完整功能链路，即：

“环境建模 → 策略评估（DP） → 图形界面可视化 → XML 日志记录 → 支持练习 4.1/4.2 的分析输出”。

#### ***\*�� 详细任务\****

**Week 3: 后端算法实现**

| ***\*任务编号\**** | ***\*任务名称\****          | ***\*主要内容\****                                           | ***\*对应实验要求\****        |
| ------------------ | --------------------------- | ------------------------------------------------------------ | ----------------------------- |
| T3.1               | BasicGridEnv 环境类实现     | 按实验说明实现：动态网格尺寸（如 4×4/5×5/6×6）、状态集合 S={1,…,N²-2}、动作空间 A={up,down,left,right}、边缘动作保持原地且 reward = -1 或 0 | 一、实验环境描述；输入 ⑴⑵⑶    |
| T3.2               | 奖励模型与终止状态逻辑      | 支持非终止状态步长奖励 0 或 -1、终止状态隐藏但可在多个位置显示为“同一终止状态” | 一、内容描述 + 实验要求       |
| T3.3               | DP 策略评估与策略改进模块   | 按预备知识中的 Bellman 方程与伪代码实现策略估计与策略改进过程，支持等概率随机策略初始化 | 一、预备知识 + 实验目的 ⑴⑵    |
| T3.4               | 迭代过程数据结构设计        | 定义每次迭代的输出：当前状态、所选动作、立即奖惩、更新前后 V(s)，用于日志与前端可视化 | 一、输出与 log 记录需求       |
| T3.5               | Basic 实验 XML 日志生成模块 | 按实验要求将每次迭代的状态、动作、即时奖惩、值函数写入 XML，文件命名规则如 BasicGridworld_YYYYMMDD_HHMM.xml | 一、输出：XML 记录            |
| T3.6               | Basic 相关 API 实现         | 实现 Basic 实验的环境初始化、参数配置、算法启动/暂停/重置、日志导出等 REST 接口；迭代数据通过 WebSocket 推送 | 一、输入输出 + 实验全流程支撑 |
| T3.7               | 后端单元测试                | 针对环境边界行为（出界、原地不动）、Bellman 更新、日志字段完整性进行单元测试 | 实验正确性保障                |

**Week 4: 前端3D渲染**

| ***\*任务编号\**** | ***\*任务名称\****          | ***\*主要内容\****                                           | ***\*对应实验要求\****        |
| ------------------ | --------------------------- | ------------------------------------------------------------ | ----------------------------- |
| T3.1               | BasicGridEnv 环境类实现     | 按实验说明实现：动态网格尺寸（如 4×4/5×5/6×6）、状态集合 S={1,…,N²-2}、动作空间 A={up,down,left,right}、边缘动作保持原地且 reward = -1 或 0 | 一、实验环境描述；输入 ⑴⑵⑶    |
| T3.2               | 奖励模型与终止状态逻辑      | 支持非终止状态步长奖励 0 或 -1、终止状态隐藏但可在多个位置显示为“同一终止状态” | 一、内容描述 + 实验要求       |
| T3.3               | DP 策略评估与策略改进模块   | 按预备知识中的 Bellman 方程与伪代码实现策略估计与策略改进过程，支持等概率随机策略初始化 | 一、预备知识 + 实验目的 ⑴⑵    |
| T3.4               | 迭代过程数据结构设计        | 定义每次迭代的输出：当前状态、所选动作、立即奖惩、更新前后 V(s)，用于日志与前端可视化 | 一、输出与 log 记录需求       |
| T3.5               | Basic 实验 XML 日志生成模块 | 按实验要求将每次迭代的状态、动作、即时奖惩、值函数写入 XML，文件命名规则如 BasicGridworld_YYYYMMDD_HHMM.xml | 一、输出：XML 记录            |
| T3.6               | Basic 相关 API 实现         | 实现 Basic 实验的环境初始化、参数配置、算法启动/暂停/重置、日志导出等 REST 接口；迭代数据通过 WebSocket 推送 | 一、输入输出 + 实验全流程支撑 |
| T3.7               | 后端单元测试                | 针对环境边界行为（出界、原地不动）、Bellman 更新、日志字段完整性进行单元测试 | 实验正确性保障                |

**Week 5: UI控制面板与集成**

| ***\*任务编号\**** | ***\*任务名称\****     | ***\*主要内容\****                                           | ***\*支撑的实验结论\****     |
| ------------------ | ---------------------- | ------------------------------------------------------------ | ---------------------------- |
| T5.1               | 实时数据表             | 在右侧数据面板中展示“状态 ID – 动作 – 立即奖惩 – 当前 V(s)”，支持按状态筛选 | 记录每次迭代更新             |
| T5.2               | 状态值逼近曲线图       | 绘制平均状态值随迭代轮数变化曲线，或选定某状态查看 V(s) 收敛曲线 | 一、实验结论分析：状态值逼近 |
| T5.3               | 策略改进对比图         | 提供“初始随机策略 vs 最终最优策略”的箭头对比视图             | 一、策略改进过程分析         |
| T5.4               | Basic XML 导出前端验证 | 调用后端 XML 导出接口，下载并检查与实验要求字段一致性        | 一、log 保存与实验报告       |
| T5.5               | Basic 实验结论模板     | 在右侧底部增加“Basic 实验结论模板”，引导填写练习 4.1/4.2 所需分析要点 | 一、练习 4.1、4.2 支撑       |
| T5.6               | Basic 实验全流程联调   | 从“场景初始化→运行 DP→曲线分析→导出 XML→撰写结论”跑通一整套流程 | Basic 实验闭环               |

#### ***\*✅ 阶段验收标准\****

· [ ] 可运行完整的DP算法求解

✅ 阶段验收标准 - [ ] 可运行完整的DP算法求解4×4网格 - [ ] 3D场景正确渲染网格、Agent、箭头 - [ ] 状态值映射为格子高度，Q值映射为颜色 - [ ] 实时看到算法迭代过程 - [ ] 收敛曲线正常显示 - [ ] XML日志符合实验要求格式 - [ ] 性能指标达标（帧率≥30fps） 

#### ***\*�� 阶段产出物\****

• Basic Gridworld 环境、DP 算法、奖励模型等后端逻辑全部实现并通过单元测试

• 前端可根据 DP 迭代结果动态展示 V(s) 热力图与策略箭头

• 支持动态输入网格尺寸、步长奖励，符合实验“输入”要求

• 迭代过程中每个状态的下一动作、立即奖惩值及值函数被正确记录到 XML 文档

• 基于系统输出可完成练习 4.1 与 4.2 的分析与解答

#### ***\*5.4 阶段三：\*******\*扩展功能开发 – Windy Gridworld 与 Cliff Walking（Week 6–8）\****

#### ***\*�� 阶段目标\****

在 Basic 基础上，实现Windy Gridworld 的 Sarsa 算法与Cliff Walking 的 Sarsa/Q-Learning 算法，完成风力/悬崖环境建模、策略收敛过程可视化、XML 记录和实验课题支撑。

#### ***\*�� 详细任务\****

**Week 6:** **Windy Gridworld 全栈实现**

**后端部分**

| ***\*任务编号\**** | ***\*任务名称\****      | ***\*主要内容\****                                           | ***\*对应实验要求\****       |
| ------------------ | ----------------------- | ------------------------------------------------------------ | ---------------------------- |
| T6.1               | WindyGridEnv 环境类实现 | 实现有起始与目标状态、列风力强度、动作集合 {up,down,left,right} 的标准 Windy 环境，支持动态网格尺寸 | 二、实验内容描述 + 输入 ⑴⑵⑶⑷ |
| T6.2               | 风力转移逻辑            | 在中间列加入风力偏移：执行动作后，再根据本列风力向上漂移若干格，考虑边界与出界情况 | 二、环境描述（横风向上吹）   |
| T6.3               | Sarsa(0) 算法实现       | 按预备知识中的 Sarsa 伪代码，实现 on-policy TD(0) 更新，奖励为 -1 直到达到目标状态 | 二、实验目的 ⑴⑵⑶             |
| T6.4               | Windy 迭代与日志结构    | 记录每一步的状态、动作、即时奖励、是否受风力、漂移步数、更新前后 Q(s,a) | 二、输出 + log               |
| T6.5               | Windy XML 导出模块      | 生成包含风力字段的 XML 文件，支持后续系列化实验（练习 6.6/6.7） | 二、完成变型系列实验         |

**前端部分**

| ***\*任务编号\**** | ***\*任务名称\****       | ***\*主要内容\****                                           | ***\*对应 UI/实验设计\****  |
| ------------------ | ------------------------ | ------------------------------------------------------------ | --------------------------- |
| T6.6               | Windy 场景选择与配置面板 | 增加 “Windy Gridworld” 选项，显示风力配置输入框（每列风力强度）、步长奖励设置等 | 左侧控制面板 – 风力配置模块 |
| T6.7               | 风力粒子特效与标签       | 在 3D 主视窗中为有风列加入向上粒子流和“气流强度 X”标签，强度越大粒子越密 | 宇宙主题风力特效            |
| T6.8               | Windy Sarsa 可视化       | 根据 Sarsa 更新的 Q 值和策略，实时更新热力图、箭头方向、轨迹线条 | Sarsa 学习过程展示          |
| T6.9               | Windy 数据面板扩展       | 在数据表中增加“风力影响”“漂移格数”字段；增加回合总回报曲线与动作频率饼图 | Windy 结论分析              |
| T6.10              | Windy 实验系列化支撑     | 验证系统可支持不同风力配置、不同参数 ε/α 的实验组合，为完成练习 6.6、6.7 提供数据与图形支撑 | 二、变型问题系列            |

**Week 7: Cliff Walking实现**

**后端部分**

| ***\*任务编号\**** | ***\*任务名称\****           | ***\*主要内容\****                                           | ***\*对应实验要求\****      |
| ------------------ | ---------------------------- | ------------------------------------------------------------ | --------------------------- |
| T7.1               | CliffWalkingEnv 环境类实现   | 实现带起点、终点和悬崖区域的无折扣 episodic 任务，动作为 {up,down,left,right}，步长奖励为 -1 | 三、实验内容描述 + 输入 ⑴⑵⑶ |
| T7.2               | 悬崖惩罚与重置逻辑           | 落入悬崖区域时给予奖励 -100，并立即将 Agent 返回起点         | 三、实验内容 + 输入 ⑶④      |
| T7.3               | Sarsa 与 Q-Learning 算法实现 | 在已有 Sarsa 的基础上实现 Q-Learning，并整理两者伪代码对应关系 | 三、实验目的 ⑶⑷ + 预备知识  |
| T7.4               | 双算法迭代数据结构           | 区分 Sarsa/Q-Learning，记录每一步的状态、动作、奖励、是否触发悬崖、Q 值更新 | 三、输出要求                |
| T7.5               | Cliff XML 日志导出           | 分别生成 Sarsa 与 Q-Learning 的 XML 日志，同时提供合并导出形式 | 三、log + 横向对比分析      |

**前端部分**

| ***\*任务编号\**** | ***\*任务名称\****           | ***\*主要内容\****                                           | ***\*对应 UI/实验设计\**** |
| ------------------ | ---------------------------- | ------------------------------------------------------------ | -------------------------- |
| T7.6               | Cliff 场景选择与悬崖配置面板 | 在实验选择中增加 “Cliff Walking”，支持输入网格尺寸、悬崖惩罚值、随机/手动设置悬崖范围 | 左侧：悬崖编辑模块         |
| T7.7               | 悬崖可视化与跌落特效         | 将悬崖区域渲染为红色半透明陨石带，触发时播放爆炸动画并显示“奖励 -100，回到起点”提示 | 3D 主视窗 – 悬崖交互       |
| T7.8               | Sarsa vs Q-Learning 分屏对比 | 实现左右分屏显示两种算法的轨迹和策略，支持同步/独立启停训练  | 双算法对比可视化           |
| T7.9               | Cliff 数据面板扩展           | 数据表添加“算法类型”“是否触发悬崖”等字段，图表中绘制两条累积回报收敛曲线 | 横向比较用图表             |
| T7.10              | Cliff 实验结论模板           | 增加针对 6.9/6.10 的分析模板，引导学生比较两算法的保守/激进策略特点 | 实验结论分析支撑           |

**Week 8:** **三实验统一、预设实验方案与性能优化**

| ***\*任务编号\**** | ***\*任务名称\****       | ***\*主要内容\****                                           |
| ------------------ | ------------------------ | ------------------------------------------------------------ |
| T8.1               | 三实验统一切换与状态记忆 | 顶部可在 Basic/Windy/Cliff 间切换，自动保存各自参数配置与视图状态 |
| T8.2               | 预设实验配置             | 为 Basic/Windy/Cliff 提供若干默认实验配置（如标准 4×4、典型风场、标准悬崖），方便课堂快速演示 |
| T8.3               | 公共组件抽象与重构       | 抽取通用控制面板控件、数据表格、图表组件，减少重复代码       |
| T8.4               | 性能优化与降级策略       | 在大网格或双算法分屏时，自动降低粒子数量、轨迹保留长度等，保证帧率 |
| T8.5               | 实验系列化场景自测       | 按实验说明中的主要练习（4.1/4.2/6.6/6.7/6.9/6.1              |

 

#### ***\*✅ 阶段验收标准\****

 • 三类实验的环境与算法在后端均已实现并通过核心功能测试

 • 前端 UI 能完整支持三类实验的输入/输出、环境特性和可视化需求

 • XML 日志中包含 Windy 的风力信息、Cliff 的悬崖触发信息

 • 平台可用于完成 Windy 系列变型（6.6/6.7）与 Cliff 算法对比（6.9/6.10）的实验与分析

### ***\*5.5 阶段四：\*******\*3D 可视化与教学辅助增强（Week 9–10）\****

#### ***\*�� 阶段目标\****

在功能完整的基础上，进一步提升 3D 场景视觉效果、人机交互体验，并补充有利于课堂讲解和学生报告撰写的辅助工具。

#### ***\*�� 详细任务\****

### **Week 9:** ***\*视觉细节与特效增强\****

 

重点围绕：终止状态高亮、Agent 尾焰、风力/悬崖动态表现、轨迹残影等，使实验过程更直观。

 

| ***\*任务编号\**** | ***\*任务名称\**** | ***\*负责人\**** | ***\*工时\**** | ***\*产出物\**** |
| ------------------ | ------------------ | ---------------- | -------------- | ---------------- |
| T9.1               | Bloom后期效果      | 前端3D           | 8h             | 目标点发光       |
| T9.2               | SSAO环境光遮蔽     | 前端3D           | 8h             | 深度感增强       |
| T9.3               | 粒子爆炸特效       | 前端3D           | 10h            | 到达目标时特效   |
| T9.4               | Agent跌落动画      | 前端3D           | 8h             | 掉入悬崖动画     |
| T9.5               | 轨迹残影效果       | 前端3D           | 8h             | 半透明轨迹线     |
| T9.6               | 材质升级           | 前端3D           | 6h             | 玻璃、金属材质   |
| T9.7               | 平滑过渡动画       | 前端3D           | 8h             | Spring动画       |

### **Week 10:** ***\*实验回放与报告辅助工具\****

重点围绕：时间轴回放、关键事件标记（风力变化、悬崖触发）、一键导出实验分析草稿等，直接服务于实验结论分析部分。

| ***\*任务编号\**** | ***\*任务名称\**** | ***\*负责人\**** | ***\*工时\**** | ***\*产出物\****     |
| ------------------ | ------------------ | ---------------- | -------------- | -------------------- |
| T10.1              | 第一人称视角       | 前端3D           | 12h            | 跟随Agent相机        |
| T10.2              | 时间轴回放         | 前端UI           | 12h            | 拖动时间轴查看历史   |
| T10.3              | 预设视角切换       | 前端3D           | 8h             | 俯视/侧视/自由视角   |
| T10.4              | 鼠标交互增强       | 前端3D           | 10h            | 悬停高亮、点击详情   |
| T10.5              | 键盘快捷键         | 前端UI           | 6h             | 空格播放、方向键视角 |
| T10.6              | 响应式布局         | 前端UI           | 8h             | 适配不同屏幕         |

#### ***\*✅ 阶段验收标准\****

· [ ] 视觉效果达到"惊艳"水平

· [ ] 动画流畅无卡顿

· [ ] 交互响应时间<100ms

· [ ] 支持多种视角切换

· [ ] 时间轴回放功能完整

· [ ] 用户体验测试通过

### ***\*5.6 阶段五：\*******\*测试与教学场景验证（Week 11）\****

#### ***\*�� 阶段目标\****

从“教学实验”的角度对系统进行功能、性能与场景化测试，保证教师可以依赖系统完成课堂演示，学生可以依赖系统完成实验和练习题分析。

重点测试内容包括：

 • 三类实验的输入要求是否全部可在 UI 中完成配置

 • 输出的 XML 文档是否包含实验要求中提到的各类字段

 • 迭代过程和收敛曲线是否与理论预期一致

 • 对于指定的参数配置，是否能重现实验讲义中的典型现象（如 Sarsa 与 Q-Learning 在悬崖问题中的策略差异）

### ***\*5.7 阶段六：部署与文档交付（Week 12）\****

#### ***\*�� 阶段目标\****

完成系统部署与归档，提供面向教师和学生的使用说明与实验指导文档，使本系统可以直接用于“实验四：格子世界”的教学。

包括但不限于：

 • 正式部署与访问地址

 • 《学生实验使用手册》（针对操作步骤与注意事项）

 • 《教师实验指导书》（针对讲解节奏、示范配置、配套练习）

 • 典型 XML 日志示例与配套分析示例

## 6. 技术标准与规范

### ***\*6\*******\*.1 编码规范\****

#### ***\*前端规范\****

· **TypeScript**：严格模式，禁止使用any

· **命名规范**： 

o 组件：PascalCase（如GridWorld3D）

o 函数/变量：camelCase（如updateGridSize）

o 常量：UPPER_SNAKE_CASE（如MAX_GRID_SIZE）

o 文件名：PascalCase（组件）或kebab-case（工具）

· **代码格式化**：Prettier（强制执行）

· **Linting**：ESLint（airbnb配置 + 自定义规则）

· **组件规范**： 

o 优先使用函数组件 + Hooks

o Props接口必须定义类型

o 复杂逻辑抽取为自定义Hook

· **注释规范**： 

/** * 计算状态值函数 * @param state 当前状态 * @param policy 策略矩阵 * @returns 状态值 */function calculateValueFunction(state: State, policy: Policy): number {  // 实现逻辑}

#### ***\*后端规范\****

· **Python**：PEP 8规范

· **命名规范**： 

o 类：PascalCase（如DPSolver）

o 函数/变量：snake_case（如calculate_q_value）

o 常量：UPPER_SNAKE_CASE（如MAX_ITERATIONS）

· **代码格式化**：Black（行长88字符）

· **Linting**：Flake8 + mypy类型检查

· **文档字符串**：Google风格 

def train_agent(env: GridWorld, episodes: int) -> Policy:   """训练强化学习智能体     Args:     env: 网格世界环境     episodes: 训练回合数       Returns:     训练好的策略       Raises:     ValueError: 如果episodes<=0   """   pass

### ***\*6\*******\*.2 Git工作流\****

#### ***\*分支策略\****

main (生产环境)

 └─ develop (开发主分支)

​    ├─ feature/xxx (功能分支)

​    ├─ bugfix/xxx (缺陷修复)

​    └─ hotfix/xxx (紧急修复)

#### ***\*提交规范（Conventional Commits）\****

<type>(<scope>): <subject>

 

<body>

 

<footer>

**Type类型**：

· feat: 新功能

· fix: 修复bug

· docs: 文档更新

· style: 代码格式（不影响功能）

· refactor: 重构

· perf: 性能优化

· test: 测试相关

· chore: 构建/工具配置

**示例**：

feat(3d): 添加粒子特效系统

 

\- 实现风力粒子效果

\- 添加爆炸特效

\- 优化粒子池性能

 

Closes #123

#### ***\*PR流程\****

1. 从develop创建功能分支
2. 完成开发并自测
3. 提交PR并填写模板
4. 通过CI自动化检查
5. 至少1人Code Review通过
6. 合并到develop
7. 删除功能分支

### ***\*6\*******\*.3 API设计规范\****

#### ***\*RESTful规范\****

· 使用名词复数表示资源：/api/v1/experiments

· HTTP方法语义： 

o GET: 查询

o POST: 创建

o PUT: 全量更新

o PATCH: 部分更新

o DELETE: 删除

· 状态码使用： 

o 200: 成功

o 201: 创建成功

o 400: 请求参数错误

o 401: 未认证

o 403: 无权限

o 404: 资源不存在

o 500: 服务器错误

#### ***\*响应格式\****

{

 "code": 0,

 "message": "success",

 "data": {},

 "timestamp": "2024-12-04T10:00:00Z"

}

#### ***\*错误响应\****

{

 "code": 40001,

 "message": "Grid size must be between 3 and 20",

 "error_type": "ValidationError",

 "timestamp": "2024-12-04T10:00:00Z"

}

### ***\*6\*******\*.4 数据库规范\****

· 表名：小写snake_case复数形式

· 字段名：小写snake_case

· 主键：统一使用id

· 时间戳：created_at、updated_at

· 软删除：使用deleted_at字段

· 外键：明确命名如experiment_id

· 索引：为常查询字段添加索引

### ***\*6\*******\*.5 测试规范\****

#### ***\*单元测试\****

· 覆盖率目标：≥80%

· 测试文件命名：test_<module>.py

· 测试函数命名：test_<function>_<scenario>

· 使用Mock隔离外部依赖

· 每个函数至少测试正常和异常路径

#### ***\*集成测试\****

· 测试API端到端流程

· 使用测试数据库

· 清理测试数据

#### ***\*E2E测试\****

· 模拟真实用户操作

· 覆盖核心业务流程

· 使用Playwright/Cypress

## 附录

### ***\*A. 术语表\****

| ***\*术语\**** | ***\*英文\****         | ***\*解释\****                             |
| -------------- | ---------------------- | ------------------------------------------ |
| 强化学习       | Reinforcement Learning | 通过与环境交互学习最优策略的机器学习方法   |
| 状态值函数     | Value Function         | 从某状态开始，遵循某策略所能获得的期望回报 |
| 动态规划       | Dynamic Programming    | 基于完整环境模型的规划方法                 |
| Sarsa          | -                      | On-policy TD控制算法                       |
| Q-Learning     | -                      | Off-policy TD控制算法                      |
| Grid World     | -                      | 格子世界，经典强化学习问题                 |

### ***\*B. 参考资料\****

1. Sutton & Barto《强化学习导论（第2版）》
2. Three.js官方文档：https://threejs.org/docs
3. React Three Fiber文档：https://docs.pmnd.rs/react-three-fiber
4. FastAPI文档：https://fastapi.tiangolo.com
5. Gymnasium文档：https://gymnasium.farama.org

### ***\*C. 联系方式\****

· **项目经理**：[姓名] - [邮箱]

· **技术负责人**：[姓名] - [邮箱]

· **项目代码仓库**：[GitHub URL]

· **项目管理看板**：[Jira/GitHub Projects URL]

## 版本历史

| ***\*版本\**** | ***\*日期\**** | ***\*修订人\**** | ***\*修订内容\****     |
| -------------- | -------------- | ---------------- | ---------------------- |
| v1.0           | 2024-12-04     | 项目组           | 初始版本，完整项目计划 |

**文档状态**：✅ 已评审通过
**下次评审日期**：2024-12-11
**批准人**：__________
**批准日期**：__________</parameter>